--Họ và tên: Vương Đinh Thanh Ngân 
--Lớp: IT004.ATCL.1
--Bài thực hành 1

CREATE DATABASE uit_qlgv

use uit_qlgv

--Câu 1: Tạo quan hệ và khai báo tất cả các ràng buộc khóa chính, khóa ngoại. Thêm vào 3 thuộc tính 
--GHICHU, DIEMTB, XEPLOAI cho quan hệ HOCVIEN.

CREATE TABLE KHOA(
	MAKHOA varchar(4),
	TENKHOA nvarchar(40),
	NGTLAP smalldatetime,
	TRGKHOA char(4),
	primary key (MAKHOA) --khoá chính
	)
CREATE TABLE MONHOC(
	MAMH varchar(10),
	TENMH nvarchar(40),
	TCLT tinyint,
	TCTH tinyint,
	MAKHOA varchar(4),
	primary key (MAMH)  --khoá chính
	)
CREATE TABLE DIEUKIEN(
	MAMH varchar(10), --thuộc tính khóa
	MAMH_TRUOC varchar(10), --thuộc tính khóa
	)
CREATE TABLE GIAOVIEN(
	MAGV char(4),
	HOTEN char(40),
	HOCVI varchar(10),
	HOCHAM varchar(10),
	GIOITINH varchar(3),
	NGAYSINH smalldatetime,
	NGVL smalldatetime,
	HESO numeric(4,2),
	MUCLUONG money,
	MAKHOA varchar(4),
	primary key (MAGV)  --khoá chính
	)
CREATE TABLE LOP(
	MALOP char(3),
	TENLOP nvarchar(40),
	TRGLOP char(5),
	SISO tinyint,
	MAGVCN char(4),
	primary key (MALOP)  --khoá chính
	)

CREATE TABLE HOCVIEN(
	MAHV char(5),
	HO varchar(40),
	TEN nvarchar(10),
	NGSINH smalldatetime,
	GIOITINH nvarchar(3),
	NOISINH nvarchar(4),
	MALOP char(3),
	primary key (MAHV)  --khoá chính
	)

CREATE TABLE GIANGDAY(
	MALOP char(3), --thuộc tính khóa
	MAMH varchar(10), --thuộc tính khóa
	MAGV char(4),
	HOCKY tinyint,
	NAM smallint,
	TUNGAY smalldatetime,
	DENNGAY smalldatetime,
	)
CREATE TABLE KETQUATHI(
	MAHV char(5), --thuộc tính khóa
	MAMH varchar(10), --thuộc tính khóa
	LANTHI tinyint, --thuộc tính khóa
	NGATHI smalldatetime,
	DIEM numeric(4,2),
	KQUA varchar(10),
	)
ALTER TABLE KHOA
ADD constraint FK_KHOA_TRGKHOA foreign key (TRGKHOA) references GIAOVIEN(MAGV)

ALTER TABLE DIEUKIEN
ADD CONSTRAINT FK_DIEUKIEN_MONHOC FOREIGN KEY (MAMH) REFERENCES MONHOC(MAMH)

ALTER TABLE DIEUKIEN
ADD CONSTRAINT FK_DIEUKIEN_MAMH_TRUOC FOREIGN KEY(MAMH_TRUOC) REFERENCES MONHOC(MAMH)

ALTER TABLE MONHOC
ADD CONSTRAINT FK_MONHOC_MAMH FOREIGN KEY (MAMH) REFERENCES DIEUKIEN(MAMH_TRUOC)

ALTER TABLE GIANGDAY
ADD CONSTRAINT FK_GIANGDAY_MONHOC FOREIGN KEY (MAMH) REFERENCES MONHOC (MAMH)

ALTER TABLE GIANGDAY
ADD CONSTRAINT FK_GIANGDAY_MONHOC FOREIGN KEY (MALOP) REFERENCES MONHOC (MALOP)

ALTER TABLE KETQUATHI
ADD CONSTRAINT FK_KETQUATHI_MONHOC FOREIGN KEY (MAMH) REFERENCES MONHOC(MAMH)

ALTER TABLE KETQUATHI
ADD CONSTRAINT FK_KETQUATHI_HOCVIEN FOREIGN KEY (MAHV) REFERENCES HOCVIEN(MAHV)

ALTER TABLE GIAOVIEN
ADD CONSTRAINT FK_GIAOVIEN_MONHOC FOREIGN KEY (MAKHOA) REFERENCES MONHOC(MAKHOA)

ALTER TABLE LOP
ADD CONSTRAINT FK_LOP_TRGLOP FOREIGN KEY (TRGLOP) REFERENCES HOCVIEN (MAHV)

ALTER TABLE LOP
ADD CONSTRAINT FK_LOP_MAGVCN FOREIGN KEY (MAGVCN) REFERENCES GIAOVIEN (MAGV)

ALTER TABLE HOCVIEN
ADD CONSTRAINT FK_HOCVIEN_LOP FOREIGN KEY (MALOP) REFERENCES LOP (MALOP)

-- Thêm vào 3 thuộc tính GHICHU, DIEMTB,XEPLOAI cho quan hệ HOCVIEN
ALTER TABLE HOCVIEN
ADD GHICHU nvarchar(50)

ALTER TABLE HOCVIEN
ADD DIEMTB numeric(4,2)

ALTER TABLE HOCVIEN
ADD XEPLOAI varchar(10)

--Câu 2:Mã học viên là một chuỗi 5 ký tự, 3 ký tự đầu là mã lớp, 2 ký tự cuối cùng là số thứ tự học viên trong lớp. VD: “K1101”

ALTER TABLE HOCVIEN
ADD CONSTRAINT CHK_MAHV CHECK(SUBSTRING(MAHV, 1, 3) = MALOP AND  ISNUMERIC(SUBSTRING('MAHV', 4, 2)) = 1)

--Câu 3: Thuộc tính GIOITINH chỉ có giá trị là “Nam” hoặc “Nu”.

ALTER TABLE GIOITINH
ADD CONSTRAINT CHK_GIOITINHGIAOVIEN CHECK(GIOITINH IN('Nam' , 'Nữ', 'None'))

ALTER TABLE HOCVIEN 
ADD CONSTRAINT CHK_GIOITINHHOCVIEN CHECK(GIOITINH IN ('Nam', 'Nữ', 'None'))

--Câu 4: Điểm số của một lần thi có giá trị từ 0 đến 10 và làm tròn 2 chữ thập phân
ALTER TABLE KETQUATHI
ADD CONSTRAINT  CHK_DIEM CHECK((diem between 0 and 10 ) and diem= round(diem,2))

--Nhâp dữ liệu--

SET DATEFORMAT DMY
use uit_qlgv
--Khoa--
INSERT INTO KHOA (MAKHOA, TENKHOA, NGTLAP, TRGKHOA) VALUES ('KHMT', N'KHOA HỌC MÁY TÍNH', '7/6/2005','GV01')
INSERT INTO KHOA (MAKHOA, TENKHOA, NGTLAP, TRGKHOA) VALUES ('HTTT', N'HỆ THỐNG THÔNG TIN', '7/6/2005','GV02')
INSERT INTO KHOA (MAKHOA, TENKHOA, NGTLAP, TRGKHOA) VALUES ('MTT', N'MẠNG VÀ TRUYỀN THÔNG', '20/10/2010','GV04')
INSERT INTO KHOA (MAKHOA, TENKHOA, NGTLAP, TRGKHOA) VALUES ('CNPM', N'CÔNG NGHỆ PHẦN MỀM', '7/6/2005', 'GV04')
INSERT INTO KHOA (MAKHOA, TENKHOA, NGTLAP, TRGKHOA) VALUES ('KTMT', N'KỸ THUẬT MÁY TÍNH', '20/12/2005','NULL')


--Lop--
INSERT INTO LOP (MALOP, TENLOP, TRGLOP, SISO, MAGVCN) VALUES ('K11', N'LỚP 1 KHOA 1', 'K1108',  '11', 'GV07')
INSERT INTO LOP (MALOP, TENLOP, TRGLOP, SISO, MAGVCN) VALUES ('K12', N'LỚP 2 KHOÁ 1', 'K1205', '12', 'GV09')
INSERT INTO LOP (MALOP, TENLOP, TRGLOP, SISO, MAGVCN) VALUES ('K13', N'LỚP 3 KHOÁ 1', 'K1305', '12', 'GV09')

--MONHOC--

INSERT INTO MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES ('THDC', N'TIN HỌC ĐẠI CƯƠNG', '4', '1', 'KHMT')
INSERT INTO MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES ('CTRR', N'CẤU TRÚC RỜI RẠC', '5', '0', 'KHMT')
INSERT INTO MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES ('CSDL', N'CƠ SỞ DỮ LIỆU', '3', '1', 'HTTT')
INSERT INTO MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES ('CTDLGT', N'CẤU TRÚC DỮ LIỆU VÀ GIẢI THUẬT', '3', '1','KHMT')
INSERT INTO MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES ('PTTKTT', N'PHÂN TÍCH THIẾT KẾ THUẬT TOÁN', '3', '0', 'KHMT')
INSERT INTO MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES ('DHMT', N'ĐỒ HOẠ MÁY TÍNH', '3', '1', 'KHMT')
INSERT INTO MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES ('KTMT', N'KIẾN TRÚC MÁY TÍNH', '3','0','KTMT')
INSERT INTO MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES ('TKCSDL' , N'THIẾT KẾ CƠ SỞ DỮ LIỆU', '3', '1', 'HTTT')
INSERT INTO MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES ('PTTKHTTT', 'PHÂN TÍCH THIẾT KẾ HỆ THỐNG THÔNG TIN', '4', '1', 'HTTT')
INSERT INTO MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES ('HDH', N'HỆ ĐIỀU HÀNH', '4', '0','KTMT')
INSERT INTO MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES ('NMCNPM', N'NHẬP MÔN CÔNG NGHỆ PHẦN MỀM', '3', '0', 'CNPM')
INSERT INTO MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES ('LTCFW', N'LẬP TRÌNH C FOR WIN', '3','1', 'CNPM')
INSERT INTO MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES ('LTHDT', N'LẬP TRÌNH HƯỚNG ĐỐI TƯỢNG','3', '1', 'CNPM')

--ĐIEUKIEN--
INSERT INTO DIEUKIEN (MAMH, MAMH_TRUOC) VALUES ('CSDL', 'CTRR')
INSERT INTO DIEUKIEN (MAMH, MAMH_TRUOC) VALUES ('CSDL', 'CTDLGT')
INSERT INTO DIEUKIEN (MAMH, MAMH_TRUOC) VALUES ('CTDLGT', 'THDC')
INSERT INTO DIEUKIEN (MAMH, MAMH_TRUOC) VALUES ('PTTKTT', 'THDC')
INSERT INTO DIEUKIEN (MAMH, MAMH_TRUOC) VALUES ('PTTKTT', 'CTDLGT')
INSERT INTO DIEUKIEN (MAMH, MAMH_TRUOC) VALUES ('DHMT', 'THDC')
INSERT INTO DIEUKIEN (MAMH, MAMH_TRUOC) VALUES ('LTHDT', 'THDC')
INSERT INTO DIEUKIEN (MAMH, MAMH_TRUOC) VALUES ('PTTKHTTTT', 'CSDL')

--GIANGDAY--
INSERT INTO GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K11', 'THDC', 'GV07', '1', '2006', '2/1/2006', '12/5/2006')
INSERT INTO GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K12', 'THDC', 'GV06', '1', '2006', '2/2/2006', '12/5/2006')
INSERT INTO GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K13', 'THDC', 'GV15', '1', '2006', '2/1/2006', '12/5/2006')
INSERT INTO GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K11', 'CTRR', 'GV02', '1', '2006', '9/1/2006', '17/5/2006')
INSERT INTO GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K12', 'CTRR', 'GV02', '1', '2006', '9/1/2006', '17/5/2006')
INSERT INTO GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K13', 'CTRR', 'GV08', '1', '2006', '1/6/2006', '15/7/2006')
INSERT INTO GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K11', 'CSDL', 'GV05', '2', '2006', '1/6/2006', '15/7/2006')
INSERT INTO GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K12', 'CSDL', 'GV09', '2', '2006', '1/6/2006', '15/7/2006')
INSERT INTO GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K13', 'CTDLGT', 'GV15', '2', '2006', '1/6/2006', '15/7/2006')
INSERT INTO GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K13', 'CSDL', 'GV05', '3', '2006', '1/8/2006', '15/12/2006')
INSERT INTO GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K13', 'DHMT', 'GV07', '3', '2006', '1/8/2006', '15/12/2006')
INSERT INTO GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K11', 'CTDLGT', 'GV15', '3', '2006', '1/8/2006', '15/12/2006')
INSERT INTO GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K12', 'CDTCLGT', 'GV15', '3', '2006', '1/8/2006', '15/12/2006')
INSERT INTO GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K11', 'HDH', 'GV04', '1', '2007', '2/1/2007', '20/3/2007')
INSERT INTO GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K12', 'HDH', 'GV04', '1', '2007', '2/1/2007', '20/3/2007')
INSERT INTO GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K11', 'DHMT', 'GV07', '1', '2007', '18/2/2007', '20/3/2007')

--GIAOVIEN--

INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGAYSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV01', 'HO THANH SON' , 'PTS', 'GS', 'NAM', '2/5/1950', '1/11/2004', '5.00', '2.250.00', 'KHMT')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGAYSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV01', 'TRAN TAM THANH', 'TS', 'PGS', 'NAM', '17/12/1965', '20/4/2004', '4.50', '2.025.000', 'HTTT')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGAYSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV01', 'DO NGHIEM PHUNG', 'TS', 'GS', 'NU', '1/8/1950', '23.9.2004', '4.00', '1.800.000', 'CNPM')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGAYSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV01', 'TRAN NAM SON', 'TS', 'PGS', 'NAM', '22/2/1961', '12/01.2005', '4.50', '2.050.000', 'KTMT')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGAYSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV01', 'MAI THANH DANH', 'THS', 'GV', 'NAM', '12/3/1958', '12/1/2005', '3.00', '1.350.00', 'HTTT')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGAYSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV01', 'TRAN DOAN HUNG', 'TS', 'GV', 'NAM', '12/3/1953', '12/1/2005', '4/50', '2.050.00', 'KHMT')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGAYSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV01', 'NGUYEN MINH TIEN', 'THS', 'GV', 'NAM', '23/1/1971', '1/3/2005', '4.00', '1.800.000','KHMT')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGAYSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV01', 'LE THI TRAN', 'KS', 'NULL', 'NU', '26/3/1974', '1/3/2005', '1.69', '760.500', 'KHMT')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGAYSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV01', 'NGUYEN TO LAN', 'THS', 'GV', 'NU', '31/12/1966', '1/3/2005', '4.00', '1.800.000','HTTT')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGAYSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV01', 'LE TRAN ANH LOAN', 'KS', 'NULL', 'NU', '17/7/1972', '1/3/2005', '1.66', '837.000', 'CNPM')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGAYSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV01', 'HO THANH TUNG', 'CN', 'NULL', 'NAM', '12/1/1980', '15/5/2005', '2.67', '1.201.00','MTT')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGAYSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV01', 'TRAN VAN ANH', 'CN', 'NULL', 'NU', '29/3/1981', '15/5/2005', '1.69', '760.000', 'CNPM')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGAYSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV01', 'NGUYEN LINH DAN', 'CN', 'NULL', 'NU', '23/5/1980', '15/5/2005', '1.69', '760.000', 'KTMT')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGAYSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV01', 'TRUONG MINH CHAU', 'THS', 'GV', 'NU', '30/11/1976', '15.5.2005', '3.00', '1.350.000', 'MTT')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGAYSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV01', 'LE HA THANH', 'THS', 'GV', 'NAM', '4/5/1978', '15/5/2005',  '3.00', '1.350.000','KHMT')

--KETQUATHI--
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1101', 'CSDL', '1', '20/7/2006', '10.00', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1101', 'CTDLGT', '1', '28/12/2006', '9.00', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1101', 'THDC', '1', '20/5/2006', '9.00', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1101', 'CTRR', '1', '13/5/2006', '9.50', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1102', 'CSDL', '1', '20/7/2006', '4/00', 'KHONG DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1102', 'CSDL', '2',  '27/7/2006', '4,25', 'KHONG DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1102', 'CSDL', '3', '10/8/2006', '4.50', 'KHONG DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1102', 'CTDLGT', '1', '28/12/2006', '4.50', 'KHONG DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1102', 'CTDLGT', '2', '5/2/2007', '4.00', 'KHONG DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1102', 'CTDLGT', '3', '15/1/2007', '6.00', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1102', 'THDC', '1', '20/5/2006', '5.00', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1102', 'CTRR', '1', '13/5/2006', '7.00','DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1103', 'CSDL', '1', '20/7/2006', '3.50', 'KHONG DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1103', 'CSDL', '2', '27/7/2006','8.25', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1103', 'CTDLGT', '1', '28/12/2006', '7.00', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1103', 'THDC', '1', '20/5/2006', '8.00', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1103', 'CTRR', '1', '13/5/2006', '6.50', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1104', 'CSDL', '1', '20/7/2006', '3.75', 'KHONG DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1104', 'CTDLGT', '1', '28/12/2006', '4.60', 'KHONG DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1104', 'THBC', '1', '20/5/2006', '4.00', 'KHONG DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1104', 'CTRR', '1', '13/5/2006', '4.00', 'KHONG DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1104', 'CTRR', '2', '20/5/2006', '3.50', 'KHONG DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1104', 'CTRR', '3', '30/6/2006', '4.00', 'KHONG DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1201', 'CSDL', '1', '20/7/2006', '6.00', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1201', 'CTDLGT', '1', '28/12/2006', '5.00', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1201', 'THDC', '1', '20/5/2006', '8.50', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1201', 'CTRR', '1', '13/5/2006', '9.00', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1201', 'CSDL', '1', '20/7/2006', '8.00', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1202', 'CTDLGT', '1', '20.5.2006', '4.00', 'KHONG DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1202', 'CTDLGT', '2', '5/1/2007', '5.00', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1202', 'THDC', '1', '20/5/2006', '4.00', 'KHONG DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1202', 'THDC', '2', '27/5/2006', '4.00', 'KHONG DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1202', 'CTRR', '1', '13/5/2006', '3.00', 'KHONG DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1202', 'CTRR', '2', '20/5/2006', '4.00', 'KHONG DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1202', 'CTRR', '3', '30/6/2006', '6.25', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1203', 'CSDL', '1', '20/7/2006', '9.25', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1203', 'CTDLGT', '1', '28/12/2006','9.50', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1203', 'THDC', '1', '20/5/2006', '10.00', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1203', 'CTRR', '1', '13/5/2006', '10.00', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1204', 'CSDL', '1', '20/7/2006', '8.50', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1204', 'CTDLGT', '1', '28/12/2006', '6.75', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1204', 'THDC', '1', '20/5/2006', '4.00', 'KHONG DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1204', 'CTRR', '1', '13/5/2006', '6.00', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1301', 'CSDL', '1', '20/12/2006', '4.25', 'KHONG DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1301', 'CTDLGT', '1', '25/7/2006', '8.00', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1302', 'THDC', '1', '20/5/2006', '6/75', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1301', 'CTRR', '1', '13/5/2006', '8.00', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1302', 'CSDL', '1', '20/12/2006', '6.75', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1302', 'CTDLGT', '1', '25/7/2006', '5.00', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1302', 'THDC', '1', '20/5/2006', '8.00', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1302', 'CTRR', '1', '13/5/2006', '8.50', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1303', 'CSDL', '1', '20/12/2006', '4.00', 'KHONG DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1303', 'CTDLGT', '1', '25/7/2006', '4.50', 'KHONG DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1303', 'CTDLGT', '2', '7/8/2006', '4.00', 'KHONG DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1303', 'CTDLGT', '3', '15/8/2006', '4.25', 'KHONG DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1303', 'THDC', '1', '20/5/2006', '4.50', 'KHONG DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1303', 'CTRR', '1', '13/5/2006', '3.25', 'KHONG DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1303', 'CTRR', '3', '20/5/2006', '5.00', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1304', 'CSDL', '1', '20/12/2006', '7.75', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1304', 'CTDLGT', '1', '25/7/2006', '9.75', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1304', 'THDC', '1', '20/5/2006', '5.50', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1304', 'CTRR', '1', '13/5/2006', '5.00', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1305', 'CSDL', '1', '20/12/2006', '9.25', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1305', 'CTDLGT', '1', '25/7/2006', '10.00', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1305', 'THDC', '1', '20/5/2006', '8.00', 'DAT')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGATHI, DIEM, KQUA) VALUES ('K1305', 'CTRR', '1', '13/5/2006', '10.00', 'DAT')

--HOCVIEN--
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1101', 'NGUYEN VAN ', 'A', '27/1/1986', 'NAM', 'TPHCM', 'K11')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1102', 'TRAN NGOC ', 'HAN', '14/3/2986', 'NU', 'KIEN GIANG', 'K11')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1103', 'HA DUY ', 'LAP', '18/4/1986', 'NAM', 'NGHE AN', 'K11')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1104', 'TRAN NGOC ', 'LINH', '30/3/1986', 'NU', 'TAY NINH', 'K11')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1105', 'TRAN MINH ', 'LONG', '27/2/1986', 'NAM', 'TPHCM', 'K11')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1106', 'LE NHAT ', 'MINH', '24/1/2986', 'NAM', 'TPHCM', 'K11')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1107', 'NGUYEN NHU ', 'NHUT', '27/2/1986', 'NAM', 'HANOI', 'K11')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1108', 'NGUYEN MANH ', 'TAM', '27/2/1986', 'NAM', 'KIEN GIANG', 'K11')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1109', 'PHAM THI THANH ', 'TAM', '27/1/1986', 'NU', 'VINH LONG', 'K11')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1110', 'LE HOAI ', 'THUONG', '5/2/1986', 'NU', 'CAN THO', 'K11')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1111', 'LE HA ', 'VINH', '25/12/1986', 'NAM', 'VINH LONG', 'K11')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1201', 'NGUYEN VAN ', 'B', '11/2/1986', 'NAM', 'TPHCM', 'K12')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1202', 'NGUYEN THI KIM ', 'DUYEN', '18/1/1986', 'NU', 'TPHCM', 'K12')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1203', 'TRAN THI KIM ', 'DUYEN', '17/9/1986','NU', 'TPHCM', 'K12')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1204', 'TRUONG MY ', 'HANH', '19/5/1986', 'NU', 'DONG NAI', 'K12')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1205', 'NGUYEN THANH ', 'NAM', '17/4/2986', 'NAM', 'TPHCM', 'K12')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1206', 'NGUYEN THI TRUC', 'THANH', '4/3/1986', 'NU', 'KIEN GIANG', 'K12')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1207', 'TRAN THI DICH', 'THUY', '8/2/1986', 'NU', 'NGHE AN', 'K12')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1208', 'HUYNH THI KIM', 'TRIEU', '8/4/1986', 'NU', 'TAY NINH', 'K12')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1209', 'PHAM THANH', 'TRIEU', '23/2/1986', 'NAM', 'TPHCM', 'K12')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1210', 'NGO THANH', 'TUAN', '14/2/1986', 'NAM', 'TPHCM', 'K12')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1211', 'DO THI', 'XUAN', '9/3/1986', 'NU', 'HA NOI', 'K12')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1212', 'LE THI PHI', 'YEN', '12/3/1986', 'NU', 'TPHCM', 'K12')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1301', 'NGUYEN THI KIM', 'CUC', '9/6/1986', 'NU', 'KIEN GIANG', 'K13')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1302', 'TRUONG THI MY', 'HIEN', '18/3/1986', 'NU', 'NGHE AN', 'K13')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1303', 'LE DUC', 'HIEN', '21/3/1986', 'NAM', 'TAY NINH', 'K13')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1304', 'LE QUANG', 'HIEN', '18/4/1986', 'NAM', 'TPHCM', 'K13')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1305', 'LE THI', 'HUONG', '27/3/1986', 'NU', 'TPHCM', 'K13')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1306', 'NGUYEN THAI', 'HUU', '30/3/1986', 'NAM', 'HA NOI', 'K13')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1307', 'TRAN MINH', 'MAN', '28/5/1986', 'NAM', 'TPHCM', 'K13')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1308', 'NGUYEN HIEU', 'NGHIA', '8/4/1986', 'NAM', 'KIEN GIANG', 'K13')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1309', 'NGUYEN TRUNG', ' NGHIA', '18/1/1987', 'NAM', 'NGHE AN', 'K13')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1310', 'TRAN THI HONG', 'THAM', '22/4/1986', 'NU', 'TAY NINH', 'K13')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1311', 'TRAN MINH', 'THUC', '4/4/1986', 'NAM', 'TPHCM', 'K13')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1312', 'NGUYEN THI KIM', 'YEN', '7/9/1986', 'NU', 'TPHCM', 'K13')


-----------------------------------Buổi 2(13/10)---------------------------------
use uit_qlgv

update KHOA
set TRGKHOA = 'GV05'
WHERE( MAKHOA ='KHMT')

update KHOA
SET TRGKHOA = 'GV06'
WHERE( MAKHOA ='HTTT')

-- làm vài ví dụ tại bài học thực hành  trên lớp
SELECT *
FROM LOP

SELECT * 
FROM HOCVIEN

SELECT *
FROM HOCVIEN
WHERE MALOP='K12'

SELECT *
FROM HOCVIEN
WHERE NOISINH = 'TPHCM' or NOISINH = 'HANOI'

SELECT concat (HO, ' ' , TEN), GIOITINH, NGSINH
FROM HOCVIEN
WHERE NOISINH in ( 'HANOI')

------Phần II ----
-- Câu 1: Tăng hệ số lương thêm 0.2 cho những giáo viên là trưởng khoa 

SELECT * FROM KHOA

UPDATE GIAOVIEN
SET HESO = HESO + 0.2
WHERE MAGV IN (SELECT TRGKHOA FROM KHOA)

-- Câu 2: Cập nhật giá trị điểm trung bình tất cả các môn học (DIEMTB) của mỗi học viên (tất cả các môn học đều có hệ số 1 
--và nếu học viên thi một môn nhiều lần, chỉ lấy điểm của lần thi sau cùng)

SELECT * FROM HOCVIEN

UPDATE HOCVIEN
SET  DIEMTB = (SELECT AVG(DIEM) 
               FROM KETQUATHI THI
			   WHERE MAHV = HOCVIEN.MAHV
			   AND LANTHI =(SELECT MAX(LANTHI) FROM KETQUATHI thi
			   WHERE thi.MAMH = THI.MAMH AND thi.MAHV = THI.MAHV))

-- 3. Cập nhật giá trị cho cột GHICHU là "Cam thi" đối với trường hợp: học viên có một môn bất kỳ thi lần thứ 3 dưới 5 điểm

UPDATE HOCVIEN
SET GHICHU = 'CAM THI'
WHERE EXISTS (SELECT * FROM KETQUATHI 
              WHERE MAHV = HOCVIEN.MAHV AND LANTHI = 3 AND DIEM <5)

-- 4. Cập nhật giá trị cho cột XEPLOAI trong quan hệ HOCVIEN:
-- Nếu DIEMTB >= 9 thì XEPLOAI =”XS”
-- Nếu 8 <= DIEMTB < 9 thì XEPLOAI = “G”
-- Nếu 6.5 <= DIEMTB < 8 thì XEPLOAI = “K”
-- Nếu 5 <= DIEMTB < 6.5 thì XEPLOAI = “TB”
-- Nếu DIEMTB < 5 thì XEPLOAI = ”Y”  

UPDATE HOCVIEN
SET XEPLOAI = 'XS'
WHERE DIEMTB >= 9

UPDATE HOCVIEN
SET XEPLOAI = 'G'
WHERE DIEMTB >= 8 AND DIEMTB < 9

UPDATE HOCVIEN
SET XEPLOAI = 'K'
WHERE DIEMTB >= 6.5 AND DIEMTB < 8

UPDATE HOCVIEN
SET XEPLOAI = 'TB'
WHERE DIEMTB >= 5 AND DIEMTB < 6.5

UPDATE HOCVIEN
SET XEPLOAI = 'Y'
WHERE DIEMTB < 5

------PHẦN 3-----

-- CÂU 1: In ra danh sách (mã học viên, họ tên , ngày sinh, mã lớp) lớp trưởng của lớp 
--C1:

SELECT MAHV, concat(HO, ' ', TEN) AS HOTEN, NGSINH, HOCVIEN.MALOP
FROM HOCVIEN INNER JOIN LOP ON HOCVIEN.MAHV = LOP.TRGLOP

--C2:

SELECT MAHV, concat(HO, ' ', TEN) AS HOTEN, NGSINH, HOCVIEN.MALOP
FROM HOCVIEN, LOP
WHERE HOCVIEN.MAHV = LOP.TRGLOP


-- CÂU 2: In ra bảng điểm khi thi( mã học viên, họ tên, lần thi, điểm số) môn CTRR của lớp "K12:, sắp xếp theo tên, họ học viên--
-- C1:

SELECT HOCVIEN.MAHV, HO, TEN, LANTHI, DIEM
FROM KETQUATHI, HOCVIEN
WHERE KETQUATHI.MAHV = HOCVIEN.MAHV
      AND MAMH = 'CTRR'
	  AND MALOP = 'K12'
ORDER BY TEN, HO
--C2:
SELECT *
FROM KETQUATHI
WHERE MAMH = 'CTRR'

SELECT *
FROM HOCVIEN
WHERE MALOP = 'K12'

SELECT HOCVIEN.MAHV, concat(HO, ' ', TEN) AS HOTEN, LANTHI, DIEM
FROM KETQUATHI, HOCVIEN
WHERE MAMH = 'CTRR' AND KETQUATHI.MAHV IN ( SELECT MAHV
									FROM HOCVIEN
									WHERE MALOP = 'K12')
ORDER BY TEN, HO

-- C3:

SELECT HOCVIEN.MAHV, concat(HO, ' ', TEN) AS HOTEN, LANTHI, DIEM
FROM KETQUATHI INNER JOIN HOCVIEN ON KETQUATHI.MAHV = HOCVIEN.MAHV
WHERE  MAMH = 'CTRR' AND MALOP = 'K12'
ORDER BY TEN, HO

-- CÂU 3: In ra danh sách những học viên( mã học viên, học tên) và những môn học mà học viên đó thi lần thứ nhất đã đạt
-- Cách 1:

SELECT HOCVIEN.MAHV, concat(HO, ' ', TEN) AS HOTEN, KETQUATHI.MAMH, TENMH
FROM KETQUATHI
INNER JOIN HOCVIEN ON HOCVIEN.MAHV = KETQUATHI.MAHV
INNER JOIN MONHOC ON MONHOC.MAMH = KETQUATHI.MAMH
WHERE LANTHI = 1 AND KQUA = N'ĐẠT' 

-- Cách 2:

SELECT HOCVIEN.MAHV, concat(HO, ' ', TEN) AS HOTEN, TENMH
FROM KETQUATHI, MONHOC, HOCVIEN
WHERE KETQUATHI.MAMH = MONHOC.MAMH
	  AND KETQUATHI.MAHV = HOCVIEN.MAHV
	  AND LANTHI = 1 AND KQUA = N'ĐẠT'
-- 4. In ra danh sách học viên của lớp "K11" thi môn CTRR không dạt (ở lần thi 1)---
-- C1
SELECT HOCVIEN.MAHV, concat(HO, ' ', TEN) AS HOTEN
FROM KETQUATHI INNER JOIN HOCVIEN ON HOCVIEN.MAHV = KETQUATHI.MAHV
WHERE MALOP = 'K11' AND MAMH = 'CTRR' AND LANTHI = 1 AND KQUA = N'KHÔNG ĐẠT'


-- C2

SELECT HOCVIEN.MAHV, concat(HO, ' ', TEN) AS HOTEN
FROM HOCVIEN, KETQUATHI
WHERE HOCVIEN.MAHV = KETQUATHI.MAHV
AND MALOP = 'K11'
AND MAMH = 'CTRR'
AND LANTHI = 1
AND KQUA = N'KHÔNG ĐẠT' 